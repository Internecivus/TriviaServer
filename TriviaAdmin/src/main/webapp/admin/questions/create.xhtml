<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:c="http://java.sun.com/jstl/core"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/templates/admin.xhtml">
    <ui:define name="title">
        <h:outputText value="#{i18n['page.question.create.name']} - #{i18n['this.name']}"/>
    </ui:define>

    <ui:define name="subnavigation">
        <div class="container text-center">
            <ul class="list-inline list-unstyled">
                <li>
                    <p:button outcome="list"
                              value="#{i18n['action.all']}"/>
                </li>
                <li>
                    <p:button outcome="create"
                              value="#{i18n['action.create']}"/>
                </li>
            </ul>
        </div>
    </ui:define>

    <ui:define name="main">
        <p:messages id="messages" globalOnly="true" showDetail="true" closable="false">
            <p:autoUpdate/>
        </p:messages>
        <p:growl id="growl" showDetail="true" sticky="true" for="growl">
            <p:autoUpdate/>
        </p:growl>

        <p:panel header="#{i18n['page.question.create.name']}">
            <h:form enctype="multipart/form-data">
                <div class="form-group">
                    <p:outputLabel for="question">#{i18n['question.question']}</p:outputLabel>
                    <p:inputText value="#{questionCreateController.questionEntity.question}"
                                 styleClass="form-control"
                                 id="question"/>
                    <p:message for="question"/>
                </div>
                <div class="form-group">
                    <p:outputLabel for="first_answer">#{i18n['question.firstAnswer']}</p:outputLabel>
                    <p:inputText value="#{questionCreateController.questionEntity.answerFirst}"
                                 styleClass="form-control"
                                 id="first_answer"/>
                    <p:message for="first_answer"/>
                </div>
                <div class="form-group">
                    <p:outputLabel for="second_answer">#{i18n['question.secondAnswer']}</p:outputLabel>
                    <p:inputText value="#{questionCreateController.questionEntity.answerSecond}"
                                 styleClass="form-control"
                                 id="second_answer"/>
                    <p:message for="second_answer"/>
                </div>
                <div class="form-group">
                    <p:outputLabel for="third_answer">#{i18n['question.thirdAnswer']}</p:outputLabel>
                    <p:inputText value="#{questionCreateController.questionEntity.answerThird}"
                                 styleClass="form-control"
                                 id="third_answer"/>
                    <p:message for="third_answer"/>
                </div>
                <div class="form-group">
                    <p:outputLabel for="fourth_answer">#{i18n['question.fourthAnswer']}</p:outputLabel>
                    <p:inputText value="#{questionCreateController.questionEntity.answerFourth}"
                                 styleClass="form-control"
                                 id="fourth_answer"/>
                    <p:message for="fourth_answer"/>
                </div>

                <!-- The convertMessage is unfortunate since we are doing "validation" on two fronts now - both bean
                validation and JSF validation. Now, since conversion happens BEFORE validation, there is nothing
                that can be done about that, outside of changing the type of the entity field to String and doing
                the conversion there or indeed changing the message somewhere else in the JSF system. -->
                <div class="form-group">
                    <p:outputLabel for="correct_answer">#{i18n['question.correctAnswer']}</p:outputLabel>
                    <p:inputText value="#{questionCreateController.questionEntity.answerCorrect}"
                                 styleClass="form-control"
                                 converterMessage="#{i18n['conversion.integer']}"
                                 id="correct_answer"/>
                    <p:message for="correct_answer"/>
                </div>
                <div class="form-group">
                    <p:outputLabel for="comment">#{i18n['question.comment']}</p:outputLabel>
                    <p:inputTextarea value="#{questionCreateController.questionEntity.comment}"
                                     styleClass="form-control"
                                     id="comment"/>
                    <p:message for="comment"/>
                </div>
                <div class="form-group">
                    <p:outputLabel for="image">#{i18n['question.image']}</p:outputLabel>
                    <p:fileUpload value="#{questionCreateController.uploadedImage}"
                                  fileLimit="1"
                                  mode="simple"
                                  allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                  auto="true"
                                  id="image"
                                  invalidFileMessage="#{i18n['upload.invalidFile']}"
                                  fileLimitMessage="#{i18n['upload.fileLimit']}"
                                  invalidSizeMessage="#{i18n['upload.invalidSize']}"
                                  sizeLimit="500000"
                                  skinSimple="true"/>
                    <p:messages for="image"/>
                </div>
                <div class="form-group">
                    <p:outputLabel for="categories">#{i18n['question.categories']}</p:outputLabel>
                    <p:selectManyCheckbox id="categories"
                                          styleClass="form-control"
                                          layout="lineDirection"
                                          value="#{questionCreateController.questionEntity.categories}">
                        <f:selectItems value="#{questionCreateController.categoriesAvailable}"
                                       var="category"
                                       itemValue="#{category}"
                                       itemLabel="#{category.name}"/>
                    </p:selectManyCheckbox>
                </div>
                <div class="form-group">
                    <p:commandButton action="#{questionCreateController.create(questionCreateController.questionEntity, questionCreateController.uploadedImage)}"
                                     type="submit"
                                     value="#{i18n['action.create']}"
                                     validateClient="true"
                                     ajax="false"/>
                    <p:commandButton value="#{i18n['action.reset']}"
                                     type="reset"/>
                </div>
            </h:form>
        </p:panel>
    </ui:define>
</ui:composition>